{% extends "base_site.html" %}
{% block content %}
<script language=javascript>
    var tDiv; // 提示信息div
        var flag = false; // 是否隐藏提示标志

        /**
        * 显示提示信息
        */
    function showTitle(div_id,info){
      tDiv = document.getElementById(div_id);
      tDiv.innerHTML = info;
      tDiv.className = 'tDiv';
      tDiv.style.display = '';
      flag = false;
    }

        /**
        * 隐藏提示信息
        */
    function hideTitle( ){
      if (!flag) {
                tDiv.style.display = 'none';
      }
    }


</script>
	<div class="conment-title">
				<form id="imageform" action="" method="POST">{% csrf_token %}
				<table border="0" cellspacing="0" cellpadding="0">
					<tr>
						<td class="refresh"><a href="/image/">刷新</a></td>
                                                <td class="start">
							<a href="#" onclick="image_start('cb','imageform','/image_start/')">启动</a>
						</td>
					  {% if user == 'admin' %}
						<td class="logout">
							<a href="#" onclick="image_checkout('cb','imageform','/image_logout/')">注销</a></td>
						<td class="upload"><a href="/image_register/">注册</a></td>
						{% endif %}
					</tr>
				</table>
			</div>
			<div class="conment-div">
				<div class="div">
			
					<table width="100%" border="0" cellspacing="0" cellpadding="0">
						<tr>
							<td width="5" background="../media/images/table/table_l.gif"></td>
							<td>
								<table width="100%" border="0" cellspacing="0" cellpadding="0" class="table" >
									<thead>
										<tr><th width="4%"><div class="th_div"><span class="rt"></span></div></th>
										<th width="10%"><span>EMI</span></th>
										<th width="10%"><span>所有者</span></th>
										<th width="10%"><span>系统/应用名称</span></th>
										<th width="10%"><span>系统/应用图标</span></th>
										<th width="10%" ><span>状态</span></th>									
										<th width="10%" ><span>系统架构</span></th>
							         {% if user == 'admin' %}
										<th width="10%" >启用/禁用</th>
										{% endif %}
									<tbody >
										{% for image in image_list.object_list %}
											<tr class="bg-color-a" >
												<td class="txc">
                                {% if image.state == 'available'%}
													<input name="cb" type="checkbox" value="{{ image.id }} {{ image.kernel_id }} {{ image.ramdisk_id }} {{ image.state }}" onclick="selectOne(this)"/>
											{% else %}
                 											<input name="cb" type="checkbox" value="{{ image.id }} {{ image.kernel_id }} {{ image.ramdisk_id }} {{ image.state }}" onclick="selectOne(this)" />
											{% endif %}
												</td>
												<td align="center" valign="middle"><a href = '/image-{{ image.id }}' onmouseover='showTitle("{{ image.id }}","查看镜像详细信息")' onmouseout='setTimeout("hideTitle()",10)' >{{ image.id }}</a><div id="{{ image.id }}"> </div></td>
  
  											  <td align="center" valign="middle">{{ image.ownerId }}</td>
										    <td align="center" valign="middle">{{ image.platform }}</td>
										    <td align="center" valign="middle">
											{% if image.platform in platforms %}
											<img src="../media/images/platform/{{ image.platform }}.jpg">
											{% else %}
											<img src="../media/images/platform/None.jpg">
											{% endif %}
											</td>
										    <td align="center" valign="middle">{{ image.state }}</td>
										    <td align="center" valign="middle">{{ image.architecture }}</td>
									{%if user == 'admin' %}	
											<td align="center" valign="middle">
									{% if image.state == 'available' %}
										<button onclick="submit_form('imageform','/imagedisable_{{image.id}}/')" value="" class="switch_bn" />禁用</button>
									{% else %}
										<button onclick="submit_form('imageform','/imageenable_{{image.id}}/')" value=""  class="switch_bn" />启用</button>
									{% endif%}
									</td>
									{% endif %}
									</tr>
						{% endfor %}
									</tbody>
								</table>

							</td>
							<td width="5" background="../media/images/table/table_r.gif"></td>
						</tr>
						<tr>
							<td width="5" height="28" background="../media/images/table/table_bl.gif"></td>
							<td background="../media/images/table/table_bc.gif" height="28">
							<div class="div_page">
							<div class="total">共有 <span>{{image_number}}</span> 条记录，<span class="current">当前第 <b>
{% if image_list %}
{{image_list.number}}/{{image_list.paginator.num_pages}}
{% else%}
1/1
{% endif %}
</b> 页 </span></div>
 {% if not page_num == 1%}              
                <div class="bn_bn">
{% if image_list %}
  {% ifequal image_list.number 1 %}
	<span class="color_a">首页</a></span>
  {% else %}
    <span class="color_a"><a href="?page=1">首页</a></span>
  {% endifequal %}
{% endif %}

{% if image_list.has_previous %}
<a href="?page={{ image_list.previous_page_number }}">上一页</a>
{% endif %}

<span>
{% for p in page_range %}
  {% if image_list %}
	  {% ifequal p image_list.number %}
	   <span> {{ p }} </span>
	  {% else %}
	    <a href="?page={{ p }}" title="第{{ p }}页">{{p}}</a>
	  {% endifequal %}
  {% else %}
          <span> {{ p }} </span>
  {% endif %}
{% endfor %}
</span>

{% if image_list.has_next %}
   <a href="?page={{ image_list.next_page_number }}">下一页</a>
   <a href="?page={{image_list.paginator.num_pages}}">尾页</a>
{% else%}
   <span class="color_a">尾页&nbsp;</a></span>   
{% endif %}


{% if image_list %}
第<input name="goto" id="goto" class="input" type="text" style="ime-mode:Disabled" onkeydown=" return goto_page(event)"/>页<input type="button" class="switch_bn" name="turn_page" id="turn_page" value="转到" onclick="javascript:GoPage('goto',{{ image_list.paginator.num_pages }},'/image/')"/>
{% else %}
到第<input name="goto" id="goto" class="input" type="text" style="ime-mode:Disabled" onkeydown=" return goto_page(event)"/>页<input type="button" class="switch_bn" name="turn_page" id="turn_page" value="转到" onclick="javascript:GoPage('goto',1,'/image/')"/>
{% endif %}
</span>
		</div>
		{% endif %}

							<div class="clear"></div>
						</div>
                    </td>
                    <td width="5" background="../media/images/table/table_br.gif">&nbsp;</td>
				</tr>
			</table>
		  </form>
		</div>
	</div>
</div>
{% endblock %}
