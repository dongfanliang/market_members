{% extends "base_site.html" %}
{% block content %}
<script language=javascript>
    var tDiv; // 提示信息div
        var flag = false; // 是否隐藏提示标志

        /**
        * 显示提示信息
        */
    function showTitle(div_id,info){
      tDiv = document.getElementById(div_id);
      tDiv.innerHTML = info;
      tDiv.className = 'tDiv';
      tDiv.style.display = '';
      flag = false;
    }

        /**
        * 隐藏提示信息
        */
    function hideTitle( ){
      if (!flag) {
                tDiv.style.display = 'none';
      }
    }


</script>

			<div class="conment-title">
            	<table border="0" cellspacing="0" cellpadding="0">
					<tr>
						<td class="refresh"><a href="/instance/">刷新</a></td>
						<td class="start"><a href="#" onclick="startInstance('cb','formInstance','/instance/start/')">启动</a></td>    
						<td class="start"><a href="#" onclick="restartInstance('cb','formInstance','/instance/restart/')">重启</a></td>    
						<td class="logout"><a href="#" onclick="shutdownInstance('cb','formInstance','/instance/start/')">关闭</a></td>    
						<td class="delete"><a href="#" onclick="stopInstance('cb','formInstance','/instance/stop/')">注销</a></td>
					</tr>
				</table>
			</div>
			
			<div class="conment-div">
				<div class="div">
					<form id = 'formInstance' action="" method="POST"> {% csrf_token %}
					<table width="100%" border="0" cellspacing="0" cellpadding="0">
					  <tr>
						<td width="5" background="/media/images/table/table_l.gif"></td>
						<td>
							<table width="100%" border="0" cellspacing="0" cellpadding="0" class="table">
									<thead>
									<tr><th width="4%"><div class="th_div"><span class="rt"></span></div></th>
                                    <th width="10%"><span>ID</span></th>
                                    <th width="10%"><span>EMI</span></th>
                                    <th width="10%"><span>状态</span></th>
                                    <th width="10%" ><span>公有IP</span></th>
                                    <th width="10%" ><span>KEY</span></th>
                                    <th width="10%" ><span>资源类型</span></th>
                                    <th width="10%" ><span>所在区域</span></th>
                                    <th width="10%" ><span>启动时间</span></th>
				                    <th width="8%" ><span>动态迁移</span></th>
										<th width="8%" ><span>远程桌面</span></th>
                                <!--    <th width="13%" ><span>启动时间</span></th>
                                    <th width="8%" ><span>所在区域</span></th>
                                    <th width="10%" ><span>所属安全组</span></th> -->
								    <tbody>
									{% for res in instances_list.object_list %}
										{% for instance in res.instances %}
										<tr class="bg-color-a">
												<td class="txc"><input name="cb" type="checkbox" value="{{ instance.id }} {{ instance.image_id }} {{ instance.kernel }} {{ instance.ramdisk }} {{ instance.key_name }} {{ instance.instance_type }} {{ instance.state }} " onclick="selectOne(this)"/></td>
											<td class="txc"><a href = '/instance_info_{{ instance.id }}' onmouseover='showTitle("{{ instance.id }}","查看虚拟机详细信息")' onmouseout='setTimeout("hideTitle()",10)' >{{ instance.id }}</a><div id="{{ instance.id }}"> </div></td>
											<td class="txc">{{ instance.image_id }}</td>
											<td class="txc">{{ instance.state }}</td>
											<td class="txc">{{ instance.public_dns_name }}</td>
											<td class="txc">{{ instance.key_name }}</td>
											<td class="txc">{{ instance.instance_type }}</td>
											<td class="txc">{{ instance.placement }}</td>
											<td class="txc">{{ instance.launch_time }}</td>
											<td class="txc"><button name = "{{ instance.id }}" value = "{{ instance.id }} {{ instance.state }}" class="switch_bn" onclick = "migrateInstance('{{ instance.id }}', 'formInstance', '/instance_move_{{ instance.id }}/')">迁移</button></td>
										 <td class="txc"><button value="" class="" onclick="window.open('http://'+'{{ instance.public_dns_name }}'+':5901');">远程桌面</button></td>
										</tr>
										{% endfor %}
									{% endfor %}
								    </tbody>
							  </table>
						</td>
						<td width="5" background="../media/images/table/table_r.gif"></td>
					</tr>
					<tr>
						<td width="5" height="28" background="../media/images/table/table_bl.gif"></td>
						<td background="../media/images/table/table_bc.gif" height="28">
                        <div class="div_page">
							<div class="total">共有 <span>{{ instance_number }}</span> 条记录，<span class="current">当前第 <b>
{% if instances_list %}
{{instances_list.number}}/{{instances_list.paginator.num_pages}}
{% else%}
1/1
{% endif %}
</b> 页 </span></div>
 {% if not page_num == 1%}              
                <div class="bn_bn">
{% if instances_list %}
  {% ifequal instances_list.number 1 %}
	<span class="color_a">首页</a></span>
  {% else %}
    <span class="color_a"><a href="?page=1">首页</a></span>
  {% endifequal %}
{% endif %}

{% if instances_list.has_previous %}
<a href="?page={{ instances_list.previous_page_number }}">上一页</a>
{% endif %}

<span>
{% for p in page_range %}
  {% if instances_list %}
	  {% ifequal p instances_list.number %}
	   <span> {{ p }} </span>
	  {% else %}
	    <a href="?page={{ p }}" title="第{{ p }}页">{{p}}</a>
	  {% endifequal %}
  {% else %}
          <span> {{ p }} </span>
  {% endif %}
{% endfor %}
</span>

{% if instances_list.has_next %}
   <a href="?page={{ instances_list.next_page_number }}">下一页</a>
   <a href="?page={{instances_list.paginator.num_pages}}">尾页</a>
{% else%}
   <span class="color_a">尾页&nbsp;</a></span>   
{% endif %}


{% if instances_list %}
第<input name="goto" id="goto" class="input" type="text" style="ime-mode:Disabled" onkeydown=" return goto_page(event)"/>页<input type="button" class="switch_bn" name="turn_page" id="turn_page" value="转到" onclick="javascript:GoPage('goto',{{ instances_list.paginator.num_pages }},'/instance/')"/>
{% else %}
到s第<input name="goto" id="goto" class="input" type="text" style="ime-mode:Disabled" onkeydown=" return goto_page(event)"/>页<input type="button" class="switch_bn" name="turn_page" id="turn_page" value="转到" onclick="javascript:GoPage('goto',1,'/instance/')"/>
{% endif %}
</span>
		</div>
		{% endif %}

							 <div class="clear"></div>
                        </div>
                        </td>
						<td width="5" background="../media/images/table/table_br.gif">&nbsp;</td>
					</tr>
				</table>
              </form>
			</div>
		</div>
	</div>
{% endblock %}
