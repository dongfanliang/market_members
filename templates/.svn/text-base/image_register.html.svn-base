<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="x-ua-compatible" content="ie=7" />

<title>方德高可信云平台管理工具</title>
{% block style %}
<link href="/media/css/main.css" rel="stylesheet" type="text/css" />
{% endblock %}
{% block js %}
<!–[if IE 6]> 
<script type="text/javascript" src="/media/js/0.0.8a-min.js"></script> 
<script> 
	DD_belatedPNG.fix('.logo, img');  
</script> 
<![end if]–> 
<script src="/media/js/jquery/jquery-1.3.2.min.js" language="javascript"></script>
<script src="/media/js/jquery/jquery.salid.js" language="javascript"></script>
<script src="/media/js/window.js" language="javascript" Charset= "GB2312"></script>
<script src="/media/js/myJS.js" language="javascript"></script>
<script src="../media/js/instance.js" language="javascript"></script>
<script src="../media/js/ippool.js" language="javascript"></script>
<script src="../media/js/image.js" language="javascript"></script> 
<script src="../media/js/group.js" language="javascript"></script>
<script src="../media/js/rule.js" language="javascript"></script>
<script src="../media/js/keypair.js" language="javascript"></script>
<script src="../media/js/vmtype.js" language="javascript"></script>
<script src="../media/js/cookie.js" language="javascript"></script>
<script src="../media/js/Date.js" language="javascript"></script>
<script type="text/javascript">


function showsubmenu(a) {
	var menu = a.attr("id");
	var submenu_id = "sub" + menu;
	submenu = document.getElementById(submenu_id);
	if(submenu.style.display!="none"){
			submenu.style.display="none";
//			if (getCookieValue(menu)!=null) deleteCookie(menu,"/");
			setCookie(menu,'none',24,"/");
	}else {
			submenu.style.display="block";
//			if (getCookieValue(menu)!=null) deleteCookie(menu,"/");
			setCookie(menu,'block',24,"/");

			}
	
}
function lod()
{
//	alert('');
	if(getCookieValue("menu2")!='')
		document.getElementById("submenu2").style.display = getCookieValue("menu2");
	else document.getElementById("submenu2").style.display = 'none';
	if(getCookieValue("menu3")!='')	
		document.getElementById("submenu3").style.display = getCookieValue("menu3");
	else document.getElementById("submenu3").style.display = 'none';
	if(getCookieValue("menu6")!='')
		document.getElementById("submenu6").style.display = getCookieValue("menu6");
	else document.getElementById("submenu6").style.display = 'none';
	if(getCookieValue("menu8")!='')
		document.getElementById("submenu8").style.display = getCookieValue("menu8");
	else document.getElementById("submenu8").style.display = 'none';
}
function logout()
{
    deleteCookie("menu2","/");
	deleteCookie("menu3","/");
	deleteCookie("menu6","/");
	deleteCookie("menu8","/");

}
var thispage = false;
window.onbeforeunload=aunload;
function aunload()
{
   
    if(!thispage) {
        location.href="/logout";
	}
}

</script>
{% endblock %}

</head>

<body id="{% block bodyid %}page{% endblock %}" onload="lod()" >
<div class="wrap">
	<div class="header">
    	<div class="logo"><img src="/media/images/logo.png" /></div>
        <div class="logo-font"><span>方德高可信云平台管理工具</span></div>
    	<div class="header-right" align="right">
		<ul>
	      <li>
		  	<br><label>欢迎，{{ user}}。谢谢您的来访。</label><a href="/logout" onclick="logout()" class="fwb"><u>退出</u></a></li></ul>
<!--        	<ul>
						<li><br><a href="/logout" onclick="logout()" class="fwb"><u>退出</u></a></li>
						<li><br><label>欢迎，{{ user}}。谢谢您的来访。</label></li>
           </ul>-->
				 </div>
			</div>
    <div class="main">
    	<div class="sidebar">
        	<!--<div class="i"></div>-->
        	<div class="sidebar-title"><h2><span>云平台管理</span></h2></div>
            <div class="sidebar-div">
            	<ul>
				  {% if user == 'admin' %}
				  <li class="open"><a id="menu0" href="/property">系统配置</a>
				  </li>
			      {% endif %}
                	<li class="open"><a id="menu1" href="/connect">连接设置</a>
                  </li>
                  <li class="open"><a id="menu2" onClick="showsubmenu($(this))">个人中心</a>
 						<div id="submenu2" style="Display: none;" >
                    	<ul class="li-div">
                        	<li class="close"><a href="/usrmodify">个人信息</a></li>
                            <li class="close"><a href="/usrpasswd">密码修改</a></li>
                      </ul>
						</div>
                  </li>								
               	<li class="open"><a id="menu3" onClick="showsubmenu($(this))">虚拟机与镜像管理</a>
  						<div id="submenu3" style="display: none; ">
                   	<ul class="li-div">
                            <li class="close"><a href="/image">镜像管理</a>
                            </li>
                        	<li class="close"><a href="/instance">虚拟机实例</a></li>
                        </ul>
						</div>
                    </li>
									
									<li class="open"><a id="menu4" href="/typelist">资源类型</a>
									</li>
									{% if user == 'admin' %}
									<li class="open"><a id="menu5" href="/zoneinfo">区域管理</a>
									</li>
									{% endif %}
                	<li class="open" ><a id="menu6"onClick="showsubmenu($(this))">安全组管理</a>
 						<div id="submenu6" style="display: none; ">
						<ul class="li-div">
                        	<li class="close"><a href="/groups">组管理</a></li>
                            <li class="open"><a href="/rules">权限管理</a>
                            </li>
                        </ul>
                     </li>
{% if user == 'admin' %}
<li class="open"><a id="menu7" href="/ippool">IP池管理</a>
                     </li>
{% endif %}
                	<li class="open"><a id="menu8" onClick="showsubmenu($(this))">存储管理</a>
 						<div id="submenu8" style="display: none; ">
                     	<ul class="li-div">
                        	<li class="close"><a href="/volume">逻辑卷管理</a></li>
                            <li class="close"><a href="/volumesnapshot">逻辑卷快照</a>
                            </li>
                        </ul></div>
                    </li>                	<li class="open"><a  id="menu9" href="/keypairs">密钥对管理</a>
                     </li>
										{% if  user == 'admin' %}	 
						<li class="open"><a  id="menu10" href="/usrlist">用户管理</a>
									</li>
									 {% endif %}
		<!--			  <li class="open"><a  id="menu11" href="/loglist">日志管理</a>
		</li>-->

</ul>
            </div>
       </div>
        <div class="ico-img">
       		<span class="img-ico"><img src="/media/images/ico-img.gif"/></span>	            
        </div>
<div class="conment" id="content">

<style type="text/css"> 
*{padding:0;margin:0} 
.pop1{z-index:1;background-color:#CCCCCC;opacity:0.5;filter:Alpha(opacity=50);-moz-opacity:.5;width:100%;height:100%;position:absolute;left:0px;top:0px;display:none}
.pop2{z-index:2;background-color:white;position:absolute;left:40%;top:40%;width:300px;height:100px;display:none} 
</style> 

<div id="pop1" class="pop1"></div> 
<div id="pop2" class="pop2" ><br><br><center><span style="font-size:18px; font-weight:bold; font-family:simsun;">正在注册镜像........</span></center> </div>

<div class="conment" id="content">
   	 <div class="conment-title">镜像注册</div>     
        <div class="conment-div">
            <div class="div">
                  <input type="hidden" id="registerregister" value="1" />
                <form id="registerForm" action="" method="POST"> {% csrf_token %}
				
                    <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="tab">

                      <tbody>
					  <th colspan="3" ><div align="center">镜像文件</div></th>
                          <tr >
<td rowspan="3"  align="center" valign="middle" width="28%" >
											<select name="select_files" size="9" multiple id="select_files" style="width:200px;">
												{% for file in files %}
										   <option value="{{ file }}" >{{ file }}</option>
												{% endfor %}
											</select>
											<br />
											<input name="do_delete_image" type="button" class="switch_bn" value="删除镜像" onclick="del_image('select_files', 'registerForm', '/image_del_upload/')" align = "center"><br />
											<p align="left"><span style="color:red;FONT-SIZE:12px;margin-left:10px;">*如果没有可选的镜像文件，可通过客户端上传</span></p>
									  </td>
<td>
											<input name="doadd" type="button" class="switch_bn" value="添加>" onclick="file_add('select_files','eki_file')"><br>
											<input name="dodel" type="button" class="switch_bn" value="<删除" onclick="file_del('eki_file', form)">
							</td>
									<td >
						    <div > Kernel：<input type="text" id="eki_file" name="eki_file" readonly="readonly" /><span style="color:red;FONT-SIZE:12px;margin-left:10px;">注：请指定正确的内核镜像文件！</span></div>									</td>
</tr>
          <tr >
<td><div >
											<input name="doadd" type="button" class="switch_bn" value="添加>" onclick="file_add('select_files','eri_file')"><br>
											<input name="dodel" type="button" class="switch_bn" value="<删除" onclick="file_del('eri_file')">
							</div></td>
				
									<td>
						    <div > Ramdisk：<input type="text" id="eri_file" name="eri_file" readonly="readonly" />
					<span style="color:red;FONT-SIZE:12px;margin-left:10px;">注：请指定正确的ramdisk镜像文件！</span></div>									</td>
</tr>
          <tr >
<td><div >
											<input name="doadd" type="button" class="switch_bn" value="添加>" onclick="file_add('select_files','emi_file')"><br>
											<input name="dodel" type="button" class="switch_bn" value="<删除" onclick="file_del('emi_file')">
							</div></td>
				
									<td width="65%">
						    <div > Rootfs：<input type="text" id="emi_file" name="emi_file" readonly="readonly" />
					<span style="color:red;FONT-SIZE:12px;margin-left:10px;">注：请指定正确的镜像文件（镜像文件的扩展名通常为.img）！</span></div>									</td>
</tr>
						 <th colspan="3" ><div align="center">镜像信息</div></th>
					
					
					 <tr align="center">
					 <td rowspan="2"  >镜像类型：	</td>
					<td colspan="2"align="left">
					<input type="radio" id="rdi_os" value="select_os" name="rd"/>系统信息 
					
					 <select name="select_os1" id="select_os1" onchange="inputchange('select_os2');">
					<option value="None" > 请选择</option>
					{% for one in os_platform %}
					 <option value="{{ one }}" > {{ one }}</option>
					{% endfor %}
					</select>
		<span>其他：</span><input name="select_os2" id="select_os2" onchange="selectchange('select_os1');"/>
					</td>
					 </tr>
					 <tr align="left">
					   <td colspan="2">
						<input type="radio" id="rdi_app" name="rd" value="select_app" align="right"/>应用信息 
					
					 <select name="select_app1" id="select_app1" onchange="inputchange('select_app2');">
					<option value="None" > 请选择</option>
					{% for one in app_platform %}
					 <option value="{{ one }}" > {{ one }}</option>
					{% endfor %}
					</select>
							<span>其他：</span><input name="select_app2"  id="select_app2" onchange="selectchange('select_app1');"/>
					</td>
				      </tr>

					 <tr align="center">
					 <td >
						
					   <div align="center">系统框架：					</div></td>
					<td colspan="2" align="left">
						    <select name="arch1" id="arch1" onchange="inputchange('arch2');">
								<option value="None" > 请选择</option>
								{% for one in arch %}
						      <option value="{{ one }}" > {{ one }}</option>
								{% endfor %}
					        </select>		
						<span>其他：</span><input name="arch2" id="arch2" onchange="selectchange('arch1');"/>
			   </td>
					</tr>
					<tr align="center">
					<td><div align="center">镜像描述：</div></td>
					<td colspan="2" align="left">
					
					<textarea name="imageinfo" cols ="40" rows = "5" maxlength="50"></textarea>
					</td>
					</tr>
                      </tbody>
				  </table>                        
            	
             
				<div class="div_page">    
										<div class="bn_bn">     
<!--                                  <button type="button" onclick="register_image('eki_file', 'eri_file', 'emi_file', 'registerForm', '/image_register/')" class="switch_bn">注册</button>-->
 <button type="button" onclick="register_image('eki_file', 'eri_file', 'emi_file', 'rd', 'registerForm', '/image_register/','pop1' ,'pop2')" class="switch_bn">注册</button>
											<button type="button" onclick="window.location.href='/image/'" class="switch_bn">取消</button>
                                </div>
                            </div> </form>
                </div>            
            </div>
      </div>
    </div>

  </div>
    <div class="footer">技术支持	中科方德软件有限公司</div>
</div>
</body>
</html>
